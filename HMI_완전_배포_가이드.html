<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESS HMI 시스템 완전 배포 가이드</title>
    <style>
        body {
            font-family: 'Malgun Gothic', '맑은 고딕', Arial, sans-serif;
            line-height: 1.8;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
            margin-bottom: 30px;
        }
        h2 {
            color: #34495e;
            border-left: 5px solid #3498db;
            padding-left: 15px;
            margin-top: 40px;
            margin-bottom: 20px;
            background-color: #ecf0f1;
            padding: 10px 15px;
        }
        h3 {
            color: #2980b9;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        h4 {
            color: #16a085;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        th {
            background-color: #3498db;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        td {
            padding: 12px;
            border: 1px solid #ddd;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .code-block {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
            font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
        }
        .file-tree {
            background-color: #f8f9fa;
            padding: 15px;
            border-left: 3px solid #3498db;
            font-family: 'Consolas', monospace;
            margin: 15px 0;
            white-space: pre;
        }
        .warning {
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
        }
        .info {
            background-color: #d1ecf1;
            border-left: 5px solid #17a2b8;
            padding: 15px;
            margin: 15px 0;
        }
        .success {
            background-color: #d4edda;
            border-left: 5px solid #28a745;
            padding: 15px;
            margin: 15px 0;
        }
        .danger {
            background-color: #f8d7da;
            border-left: 5px solid #dc3545;
            padding: 15px;
            margin: 15px 0;
        }
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        li {
            margin: 8px 0;
        }
        .step {
            background-color: #e8f4f8;
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            border-left: 5px solid #2980b9;
        }
        .step-number {
            display: inline-block;
            background-color: #2980b9;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            text-align: center;
            line-height: 30px;
            font-weight: bold;
            margin-right: 10px;
        }
        .checklist {
            list-style-type: none;
            padding-left: 0;
        }
        .checklist li:before {
            content: "☐ ";
            font-size: 18px;
            margin-right: 10px;
        }
        .badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 5px;
        }
        .badge-required {
            background-color: #dc3545;
            color: white;
        }
        .badge-optional {
            background-color: #ffc107;
            color: #333;
        }
        .badge-recommended {
            background-color: #28a745;
            color: white;
        }
        .page-break {
            page-break-after: always;
        }
        @media print {
            body {
                background-color: white;
                padding: 0;
            }
            .container {
                box-shadow: none;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ESS HMI 시스템 완전 배포 가이드</h1>

        <div class="info">
            <strong>📋 문서 정보</strong><br>
            작성일: 2025년<br>
            대상: ESS HMI 시스템 운영자 및 관리자<br>
            목적: USB를 통한 HMI 배포 및 자동 실행 설정
        </div>

        <h2>📊 1. 프로젝트 용량 분석</h2>

        <h3>1.1 전체 용량 개요</h3>
        <table>
            <tr>
                <th>구분</th>
                <th>용량</th>
                <th>비율</th>
                <th>배포 시 필요 여부</th>
            </tr>
            <tr>
                <td>Frontend (개발 파일)</td>
                <td>88MB</td>
                <td>71%</td>
                <td>❌ 불필요</td>
            </tr>
            <tr>
                <td>Frontend (빌드 결과)</td>
                <td>325KB</td>
                <td>&lt;1%</td>
                <td>✅ 필수</td>
            </tr>
            <tr>
                <td>Backend (Python 환경)</td>
                <td>37MB</td>
                <td>30%</td>
                <td>✅ 필수</td>
            </tr>
            <tr>
                <td>Backend (소스코드)</td>
                <td>33KB</td>
                <td>&lt;1%</td>
                <td>✅ 필수</td>
            </tr>
            <tr>
                <td><strong>총 배포 용량</strong></td>
                <td><strong>약 38MB</strong></td>
                <td><strong>100%</strong></td>
                <td><strong>-</strong></td>
            </tr>
        </table>

        <h3>1.2 상세 파일 구조</h3>

        <h4>Frontend 구조</h4>
        <div class="file-tree">frontend/
├── node_modules/           87MB  ← 개발 의존성 (삭제 가능)
│   ├── lucide-react       26MB
│   ├── @babel             11MB
│   ├── @esbuild           9.5MB
│   ├── recharts           5.2MB
│   └── 기타               35.3MB
├── node_modules/.vite/     2.8MB ← 개발 캐시 (삭제 가능)
├── dist/                   325KB ← 빌드 결과물 (배포 필수)
│   ├── index.html
│   └── assets/
│       ├── index-xxxxx.js
│       └── index-xxxxx.css
└── src/                    ~100KB ← 소스코드 (백업 보관)</div>

        <h4>Backend 구조</h4>
        <div class="file-tree">backend/
├── venv/                   37MB  ← Python 가상환경 (배포 필수)
│   ├── Lib/               35MB
│   │   └── site-packages/
│   │       ├── pip        13MB
│   │       ├── pydantic   9.6MB
│   │       ├── pymodbus   1.6MB
│   │       ├── fastapi    1.4MB
│   │       ├── websockets 1.5MB
│   │       └── 기타       8.9MB
│   └── Scripts/           1.7MB
├── main.py                 12KB  ← FastAPI 서버 (배포 필수)
├── modbus_client.py        21KB  ← Modbus 통신 (배포 필수)
├── requirements.txt        96B   ← 의존성 목록 (배포 필수)
└── __pycache__/            44KB  ← 캐시 (삭제 가능)</div>

        <div class="page-break"></div>

        <h2>🚀 2. 배포 준비 (개발 PC 작업)</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>Frontend 빌드</strong>
        </div>
        <div class="code-block">cd frontend
npm run build</div>
        <div class="success">
            ✅ <strong>빌드 성공 확인:</strong> frontend/dist/ 폴더에 index.html과 assets 폴더가 생성됨
        </div>

        <div class="step">
            <span class="step-number">2</span>
            <strong>불필요한 파일 정리</strong>
        </div>

        <h4>자동 정리 (권장)</h4>
        <div class="code-block">REM 캐시 파일 삭제
del /s /q backend\__pycache__
del /s /q backend\nul
del /s /q frontend\nul

REM 개발 파일 삭제 (선택사항 - 백업 후 진행)
REM rd /s /q frontend\node_modules
REM rd /s /q frontend\src</div>

        <h4>수동 정리</h4>
        <table>
            <tr>
                <th>파일/폴더</th>
                <th>용량</th>
                <th>삭제 여부</th>
                <th>비고</th>
            </tr>
            <tr>
                <td>frontend/node_modules/</td>
                <td>87MB</td>
                <td>✅ 삭제 가능</td>
                <td>빌드 후 불필요, npm install로 복구 가능</td>
            </tr>
            <tr>
                <td>frontend/src/</td>
                <td>~100KB</td>
                <td>⚠️ 백업 후 삭제</td>
                <td>소스 코드이므로 반드시 백업</td>
            </tr>
            <tr>
                <td>frontend/.vite/</td>
                <td>2.8MB</td>
                <td>✅ 삭제 가능</td>
                <td>개발 캐시</td>
            </tr>
            <tr>
                <td>backend/__pycache__/</td>
                <td>44KB</td>
                <td>✅ 삭제 가능</td>
                <td>Python 캐시, 자동 재생성됨</td>
            </tr>
            <tr>
                <td>backend/venv/</td>
                <td>37MB</td>
                <td>❌ 삭제 불가</td>
                <td>실행에 필수</td>
            </tr>
            <tr>
                <td>*.md 문서 파일들</td>
                <td>~100KB</td>
                <td>⚠️ 선택</td>
                <td>필요한 문서만 보관</td>
            </tr>
        </table>

        <div class="step">
            <span class="step-number">3</span>
            <strong>배포 폴더 구조 확인</strong>
        </div>
        <div class="file-tree">HMI_REAL/               (배포 폴더)
├── frontend/
│   └── dist/           (325KB) ✅ 필수
│       ├── index.html
│       └── assets/
├── backend/
│   ├── main.py         (12KB)  ✅ 필수
│   ├── modbus_client.py (21KB) ✅ 필수
│   ├── requirements.txt (96B)  ✅ 필수
│   └── venv/           (37MB)  ✅ 필수
├── simulator/
│   └── plc_simulator.py        ✅ 필수
├── START_HMI_DEPLOY.bat        ✅ 필수 (배포 전용 실행 파일)
├── 자동실행.bat                ✅ 권장 (자동 실행용)
├── STOP_HMI.bat                ✅ 권장
└── 자동실행_설정_가이드.txt    ✅ 권장

총 용량: 약 38MB</div>

        <div class="page-break"></div>

        <h2>💾 3. USB 저장 및 전송</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>USB 준비</strong>
        </div>
        <ul>
            <li>권장 용량: 최소 256MB 이상 (여유 있게 1GB 이상)</li>
            <li>파일 시스템: FAT32 또는 NTFS</li>
            <li>USB 포맷 (선택사항): 기존 파일 삭제 후 사용</li>
        </ul>

        <div class="step">
            <span class="step-number">2</span>
            <strong>파일 복사</strong>
        </div>
        <ol>
            <li>USB 드라이브를 PC에 연결</li>
            <li>HMI_REAL 폴더 전체를 USB로 복사
                <ul>
                    <li>복사 예상 시간: 약 1-2분 (USB 속도에 따라 다름)</li>
                    <li>복사 완료 용량: 약 38MB</li>
                </ul>
            </li>
            <li>복사 완료 후 파일 무결성 확인
                <ul>
                    <li>frontend/dist/index.html 존재 확인</li>
                    <li>backend/venv/ 폴더 존재 확인</li>
                    <li>START_HMI_DEPLOY.bat 존재 확인</li>
                </ul>
            </li>
        </ol>

        <div class="warning">
            <strong>⚠️ 주의사항</strong><br>
            • USB 안전 제거 후 분리하세요 (데이터 손상 방지)<br>
            • 복사 중 USB를 제거하지 마세요<br>
            • 복사 완료 후 반드시 "하드웨어 안전하게 제거" 실행
        </div>

        <div class="step">
            <span class="step-number">3</span>
            <strong>압축 파일로 전송 (선택사항)</strong>
        </div>
        <div class="info">
            파일 개수가 많아 복사 시간이 오래 걸릴 경우 압축하여 전송하면 빠릅니다.
        </div>
        <ol>
            <li>HMI_REAL 폴더 우클릭 → "보내기" → "압축(zip) 폴더"</li>
            <li>생성된 HMI_REAL.zip 파일을 USB로 복사 (약 20-25MB로 압축됨)</li>
            <li>HMI PC에서 압축 해제 후 사용</li>
        </ol>

        <div class="page-break"></div>

        <h2>🖥️ 4. HMI PC 설치</h2>

        <div class="step">
            <span class="step-number">1</span>
            <strong>사전 요구사항 확인</strong>
        </div>
        <table>
            <tr>
                <th>항목</th>
                <th>요구사항</th>
                <th>확인 방법</th>
            </tr>
            <tr>
                <td>운영체제</td>
                <td>Windows 10/11</td>
                <td>-</td>
            </tr>
            <tr>
                <td>Python</td>
                <td>3.8 이상 (venv 포함 시 불필요)</td>
                <td>명령 프롬프트에서: <code>python --version</code></td>
            </tr>
            <tr>
                <td>웹 브라우저</td>
                <td>Chrome, Edge, Firefox 등</td>
                <td>-</td>
            </tr>
            <tr>
                <td>디스크 여유 공간</td>
                <td>최소 100MB</td>
                <td>-</td>
            </tr>
            <tr>
                <td>관리자 권한</td>
                <td>필요 (포트 502 사용)</td>
                <td>-</td>
            </tr>
        </table>

        <div class="step">
            <span class="step-number">2</span>
            <strong>파일 설치</strong>
        </div>
        <ol>
            <li>USB를 HMI PC에 연결</li>
            <li>USB의 HMI_REAL 폴더를 원하는 위치로 복사
                <ul>
                    <li>권장 경로: <code>C:\HMI_REAL</code></li>
                    <li>또는: <code>C:\Program Files\ESS_HMI</code></li>
                </ul>
            </li>
            <li>복사 완료 후 폴더 구조 확인</li>
        </ol>

        <div class="step">
            <span class="step-number">3</span>
            <strong>실행 테스트</strong>
        </div>
        <ol>
            <li>설치 폴더로 이동 (예: <code>C:\HMI_REAL</code>)</li>
            <li><strong>START_HMI_DEPLOY.bat</strong> 파일을 <strong>관리자 권한</strong>으로 실행
                <ul>
                    <li>파일 우클릭 → "관리자 권한으로 실행"</li>
                </ul>
            </li>
            <li>3개의 창이 열림:
                <ul>
                    <li>창 1: PLC 시뮬레이터 (192.168.0.130:502)</li>
                    <li>창 2: 백엔드 서버 (localhost:8000)</li>
                    <li>창 3: 웹 브라우저 (HMI 화면)</li>
                </ul>
            </li>
            <li>브라우저에서 HMI 화면이 정상적으로 표시되는지 확인</li>
            <li>실시간 데이터가 1초마다 업데이트되는지 확인</li>
        </ol>

        <div class="success">
            ✅ <strong>정상 실행 확인 사항:</strong><br>
            • PLC 시뮬레이터 창에 "Modbus TCP 서버 시작" 메시지 표시<br>
            • 백엔드 서버 창에 "Uvicorn running on http://127.0.0.1:8000" 표시<br>
            • 브라우저에서 HMI 화면이 표시되고 데이터가 갱신됨
        </div>

        <div class="danger">
            <strong>❌ 오류 발생 시:</strong><br>
            <strong>오류 1:</strong> "Python 가상환경이 없습니다"<br>
            → 해결: backend/venv 폴더가 올바르게 복사되었는지 확인<br>
            <br>
            <strong>오류 2:</strong> "포트 502를 사용할 수 없습니다"<br>
            → 해결: 관리자 권한으로 실행했는지 확인<br>
            <br>
            <strong>오류 3:</strong> "빌드된 프론트엔드 파일이 없습니다"<br>
            → 해결: frontend/dist/index.html 파일이 있는지 확인
        </div>

        <div class="page-break"></div>

        <h2>⚙️ 5. 자동 실행 설정</h2>

        <div class="info">
            HMI PC 부팅 시 자동으로 HMI 시스템이 실행되도록 설정하는 방법입니다.
        </div>

        <h3>5.1 방법 1: 시작프로그램 폴더 (권장)</h3>

        <div class="step">
            <span class="step-number">1</span>
            <strong>시작프로그램 폴더 열기</strong>
        </div>
        <ol>
            <li>키보드에서 <code>Windows + R</code> 키를 동시에 누릅니다</li>
            <li>"실행" 창에 <code>shell:startup</code> 입력 후 엔터</li>
            <li>"시작프로그램" 폴더가 열림</li>
        </ol>

        <div class="step">
            <span class="step-number">2</span>
            <strong>바로가기 생성</strong>
        </div>
        <ol>
            <li>HMI 설치 폴더 열기 (예: <code>C:\HMI_REAL</code>)</li>
            <li><strong>자동실행.bat</strong> 파일을 찾습니다</li>
            <li>자동실행.bat 파일을 우클릭 → "바로 가기 만들기"</li>
            <li>생성된 바로가기를 "시작프로그램" 폴더로 복사/이동</li>
        </ol>

        <div class="step">
            <span class="step-number">3</span>
            <strong>관리자 권한 설정</strong>
        </div>
        <ol>
            <li>시작프로그램 폴더의 바로가기 우클릭 → "속성"</li>
            <li>"바로 가기" 탭 → "고급" 버튼 클릭</li>
            <li>"관리자 권한으로 실행" 체크</li>
            <li>"확인" → "확인" 클릭</li>
        </ol>

        <div class="step">
            <span class="step-number">4</span>
            <strong>테스트</strong>
        </div>
        <ol>
            <li>PC 재부팅</li>
            <li>로그인 후 자동으로 HMI가 실행되는지 확인</li>
            <li>문제 발생 시 <code>C:\HMI_REAL\autostart.log</code> 파일 확인</li>
        </ol>

        <div class="success">
            ✅ <strong>장점:</strong> 설정이 간단하고 안전함<br>
            ⚠️ <strong>단점:</strong> 사용자 로그인 후에만 실행됨
        </div>

        <h3>5.2 방법 2: 작업 스케줄러 (고급)</h3>

        <div class="step">
            <span class="step-number">1</span>
            <strong>작업 스케줄러 실행</strong>
        </div>
        <ol>
            <li>Windows 검색에서 "작업 스케줄러" 검색 및 실행</li>
            <li>우측 메뉴에서 "작업 만들기" 클릭</li>
        </ol>

        <div class="step">
            <span class="step-number">2</span>
            <strong>일반 탭 설정</strong>
        </div>
        <ul>
            <li>이름: <code>ESS HMI 자동실행</code></li>
            <li>설명: <code>ESS HMI 시스템 자동 실행</code></li>
            <li>"가장 높은 수준의 권한으로 실행" 체크 ✅</li>
            <li>"사용자의 로그온 여부에 관계없이 실행" 선택</li>
        </ul>

        <div class="step">
            <span class="step-number">3</span>
            <strong>트리거 탭 설정</strong>
        </div>
        <ol>
            <li>"새로 만들기" 버튼 클릭</li>
            <li>"작업 시작": <strong>시작할 때</strong> 선택</li>
            <li>"지연 시간": <strong>30초</strong> 설정 (시스템 안정화 대기)</li>
            <li>"확인" 클릭</li>
        </ol>

        <div class="step">
            <span class="step-number">4</span>
            <strong>동작 탭 설정</strong>
        </div>
        <ol>
            <li>"새로 만들기" 버튼 클릭</li>
            <li>작업: <strong>프로그램 시작</strong></li>
            <li>프로그램/스크립트: <code>C:\HMI_REAL\자동실행.bat</code></li>
            <li>시작 위치: <code>C:\HMI_REAL</code></li>
            <li>"확인" 클릭</li>
        </ol>

        <div class="step">
            <span class="step-number">5</span>
            <strong>조건 탭 설정</strong>
        </div>
        <ul>
            <li>"컴퓨터의 전원이 AC 전원일 때만 작업 시작" 체크 해제 ❌</li>
            <li>"컴퓨터가 유휴 상태일 때만 작업 시작" 체크 해제 ❌</li>
        </ul>

        <div class="step">
            <span class="step-number">6</span>
            <strong>설정 탭 설정</strong>
        </div>
        <ul>
            <li>"작업이 실행되지 못한 경우 가능한 빨리 작업 실행" 체크 ✅</li>
            <li>"요청 시 작업 종료" 체크 ✅</li>
        </ul>

        <div class="step">
            <span class="step-number">7</span>
            <strong>저장 및 테스트</strong>
        </div>
        <ol>
            <li>"확인" 버튼을 눌러 작업 저장</li>
            <li>관리자 암호 입력 (필요 시)</li>
            <li>작업 스케줄러 라이브러리에서 생성된 작업 확인</li>
            <li>작업 우클릭 → "실행" 하여 즉시 테스트</li>
            <li>PC 재부팅하여 자동 실행 확인</li>
        </ol>

        <div class="success">
            ✅ <strong>장점:</strong><br>
            • 부팅 즉시 실행 (로그인 불필요)<br>
            • 관리자 권한으로 자동 실행<br>
            • 실행 실패 시 재시도 가능<br>
            <br>
            ⚠️ <strong>단점:</strong><br>
            • 설정이 복잡함<br>
            • Windows 전문 지식 필요
        </div>

        <div class="page-break"></div>

        <h2>🔧 6. 운영 및 관리</h2>

        <h3>6.1 정상 작동 확인</h3>
        <table>
            <tr>
                <th>확인 항목</th>
                <th>확인 방법</th>
                <th>정상 상태</th>
            </tr>
            <tr>
                <td>PLC 시뮬레이터</td>
                <td>명령 프롬프트 창 확인</td>
                <td>"Modbus TCP 서버 시작" 메시지 표시</td>
            </tr>
            <tr>
                <td>백엔드 서버</td>
                <td>명령 프롬프트 창 확인</td>
                <td>"Uvicorn running" 메시지 표시</td>
            </tr>
            <tr>
                <td>HMI 화면</td>
                <td>웹 브라우저 확인</td>
                <td>화면 표시 및 데이터 갱신</td>
            </tr>
            <tr>
                <td>데이터 통신</td>
                <td>HMI 화면의 값 변화</td>
                <td>1초마다 데이터 업데이트</td>
            </tr>
        </table>

        <h3>6.2 수동 시작 및 종료</h3>

        <h4>시작 방법</h4>
        <ol>
            <li>설치 폴더로 이동 (예: <code>C:\HMI_REAL</code>)</li>
            <li><strong>START_HMI_DEPLOY.bat</strong> 우클릭 → "관리자 권한으로 실행"</li>
            <li>자동으로 브라우저가 열리고 HMI 화면 표시</li>
        </ol>

        <h4>종료 방법</h4>
        <ol>
            <li><strong>STOP_HMI.bat</strong> 실행 (권장)</li>
            <li>또는 각 명령 프롬프트 창에서 <code>Ctrl + C</code> 입력</li>
            <li>또는 각 명령 프롬프트 창을 닫기</li>
        </ol>

        <h3>6.3 자동 실행 해제</h3>

        <h4>방법 1 사용 시 (시작프로그램)</h4>
        <ol>
            <li><code>Windows + R</code> → <code>shell:startup</code></li>
            <li>HMI 바로가기 삭제</li>
        </ol>

        <h4>방법 2 사용 시 (작업 스케줄러)</h4>
        <ol>
            <li>작업 스케줄러 실행</li>
            <li>"ESS HMI 자동실행" 작업 찾기</li>
            <li>우클릭 → "사용 안 함" 또는 "삭제"</li>
        </ol>

        <h3>6.4 로그 확인</h3>
        <ul>
            <li>자동 실행 로그: <code>C:\HMI_REAL\autostart.log</code></li>
            <li>백엔드 오류 확인: 백엔드 서버 명령 프롬프트 창</li>
            <li>시뮬레이터 오류 확인: 시뮬레이터 명령 프롬프트 창</li>
        </ul>

        <div class="page-break"></div>

        <h2>🐛 7. 문제 해결</h2>

        <h3>7.1 일반적인 문제</h3>

        <table>
            <tr>
                <th>문제</th>
                <th>원인</th>
                <th>해결방법</th>
            </tr>
            <tr>
                <td>프로그램이 시작되지 않음</td>
                <td>관리자 권한 부족</td>
                <td>배치 파일을 관리자 권한으로 실행</td>
            </tr>
            <tr>
                <td>PLC 시뮬레이터 오류</td>
                <td>포트 502 사용 중</td>
                <td>다른 프로그램이 502 포트를 사용 중인지 확인</td>
            </tr>
            <tr>
                <td>백엔드 서버 오류</td>
                <td>venv 폴더 손상</td>
                <td>backend/venv 폴더를 다시 복사</td>
            </tr>
            <tr>
                <td>HMI 화면 표시 안됨</td>
                <td>빌드 파일 누락</td>
                <td>frontend/dist/ 폴더 확인</td>
            </tr>
            <tr>
                <td>데이터가 갱신되지 않음</td>
                <td>백엔드 연결 실패</td>
                <td>백엔드 서버가 정상 실행 중인지 확인</td>
            </tr>
            <tr>
                <td>자동 실행이 안됨</td>
                <td>설정 오류</td>
                <td>autostart.log 파일 확인</td>
            </tr>
        </table>

        <h3>7.2 고급 문제 해결</h3>

        <h4>Python 가상환경 재생성 (venv 손상 시)</h4>
        <div class="code-block">cd C:\HMI_REAL\backend
rd /s /q venv
python -m venv venv
venv\Scripts\activate
pip install -r requirements.txt</div>

        <h4>포트 사용 확인</h4>
        <div class="code-block">REM 502 포트 사용 확인
netstat -ano | findstr :502

REM 8000 포트 사용 확인
netstat -ano | findstr :8000

REM 프로세스 종료 (PID 확인 후)
taskkill /PID [프로세스ID] /F</div>

        <h4>방화벽 설정</h4>
        <ol>
            <li>Windows 방화벽 → 고급 설정</li>
            <li>인바운드 규칙 → 새 규칙</li>
            <li>포트 → TCP → 특정 로컬 포트: 502, 8000</li>
            <li>연결 허용 → 규칙 이름: ESS HMI</li>
        </ol>

        <div class="page-break"></div>

        <h2>✅ 8. 배포 체크리스트</h2>

        <h3>8.1 개발 PC 작업</h3>
        <ul class="checklist">
            <li>Frontend 빌드 완료 (npm run build)</li>
            <li>frontend/dist/ 폴더 생성 확인</li>
            <li>backend/venv/ 폴더 존재 확인</li>
            <li>불필요한 캐시 파일 삭제 (__pycache__, nul 등)</li>
            <li>START_HMI_DEPLOY.bat 파일 포함</li>
            <li>자동실행.bat 파일 포함</li>
            <li>STOP_HMI.bat 파일 포함</li>
            <li>총 용량 약 38MB 확인</li>
        </ul>

        <h3>8.2 USB 전송</h3>
        <ul class="checklist">
            <li>USB 용량 충분 확인 (최소 256MB)</li>
            <li>HMI_REAL 폴더 전체 복사</li>
            <li>복사 완료 후 파일 확인</li>
            <li>USB 안전하게 제거</li>
        </ul>

        <h3>8.3 HMI PC 설치</h3>
        <ul class="checklist">
            <li>Windows 10/11 확인</li>
            <li>관리자 권한 확보</li>
            <li>USB에서 HMI PC로 파일 복사</li>
            <li>설치 경로 확정 (예: C:\HMI_REAL)</li>
            <li>START_HMI_DEPLOY.bat 관리자 권한으로 실행</li>
            <li>PLC 시뮬레이터 정상 실행 확인</li>
            <li>백엔드 서버 정상 실행 확인</li>
            <li>HMI 화면 정상 표시 확인</li>
            <li>데이터 1초마다 갱신 확인</li>
        </ul>

        <h3>8.4 자동 실행 설정 (선택)</h3>
        <ul class="checklist">
            <li>자동 실행 방법 선택 (시작프로그램 또는 작업 스케줄러)</li>
            <li>설정 완료</li>
            <li>PC 재부팅 테스트</li>
            <li>자동 실행 확인</li>
            <li>autostart.log 로그 확인</li>
        </ul>

        <div class="page-break"></div>

        <h2>📚 9. 참고 자료</h2>

        <h3>9.1 파일 설명</h3>
        <table>
            <tr>
                <th>파일명</th>
                <th>용도</th>
                <th>실행 권한</th>
            </tr>
            <tr>
                <td>START_HMI_DEPLOY.bat</td>
                <td>배포 환경용 HMI 시작</td>
                <td>관리자 필요</td>
            </tr>
            <tr>
                <td>자동실행.bat</td>
                <td>Windows 부팅 시 자동 실행</td>
                <td>관리자 필요</td>
            </tr>
            <tr>
                <td>STOP_HMI.bat</td>
                <td>HMI 시스템 종료</td>
                <td>일반 사용자</td>
            </tr>
            <tr>
                <td>INSTALL_DEPENDENCIES.bat</td>
                <td>의존성 설치 (옵션 2 배포)</td>
                <td>일반 사용자</td>
            </tr>
            <tr>
                <td>자동실행_설정_가이드.txt</td>
                <td>자동 실행 설정 방법</td>
                <td>-</td>
            </tr>
        </table>

        <h3>9.2 포트 정보</h3>
        <table>
            <tr>
                <th>서비스</th>
                <th>포트</th>
                <th>프로토콜</th>
                <th>용도</th>
            </tr>
            <tr>
                <td>PLC 시뮬레이터</td>
                <td>502</td>
                <td>TCP</td>
                <td>Modbus TCP 통신</td>
            </tr>
            <tr>
                <td>백엔드 API</td>
                <td>8000</td>
                <td>HTTP</td>
                <td>REST API 서버</td>
            </tr>
            <tr>
                <td>WebSocket</td>
                <td>8000</td>
                <td>WebSocket</td>
                <td>실시간 데이터 전송</td>
            </tr>
        </table>

        <h3>9.3 주요 경로</h3>
        <table>
            <tr>
                <th>항목</th>
                <th>경로</th>
            </tr>
            <tr>
                <td>HMI 화면</td>
                <td>frontend/dist/index.html</td>
            </tr>
            <tr>
                <td>백엔드 서버</td>
                <td>backend/main.py</td>
            </tr>
            <tr>
                <td>PLC 시뮬레이터</td>
                <td>simulator/plc_simulator.py</td>
            </tr>
            <tr>
                <td>Python 가상환경</td>
                <td>backend/venv/</td>
            </tr>
            <tr>
                <td>자동 실행 로그</td>
                <td>autostart.log</td>
            </tr>
        </table>

        <h3>9.4 기술 지원</h3>
        <div class="info">
            <strong>📞 문의사항</strong><br>
            설치 또는 운영 중 문제 발생 시:<br>
            1. autostart.log 파일 확인<br>
            2. 명령 프롬프트 창의 오류 메시지 확인<br>
            3. 문제 해결 섹션 참조<br>
            4. 기술 지원팀 문의 시 로그 파일 첨부
        </div>

        <div class="page-break"></div>

        <h2>📝 10. 부록</h2>

        <h3>10.1 배포 옵션 비교</h3>
        <table>
            <tr>
                <th>항목</th>
                <th>옵션 1: venv 포함</th>
                <th>옵션 2: venv 제외</th>
            </tr>
            <tr>
                <td>배포 용량</td>
                <td>38MB</td>
                <td>350KB</td>
            </tr>
            <tr>
                <td>USB 전송 시간</td>
                <td>1-2분</td>
                <td>10초 이내</td>
            </tr>
            <tr>
                <td>HMI 설치 시간</td>
                <td>2-3분</td>
                <td>5-10분</td>
            </tr>
            <tr>
                <td>인터넷 필요</td>
                <td>불필요</td>
                <td>필요 (pip install)</td>
            </tr>
            <tr>
                <td>설치 난이도</td>
                <td>쉬움</td>
                <td>중간</td>
            </tr>
            <tr>
                <td>권장 환경</td>
                <td>인터넷 제한 환경</td>
                <td>빈번한 업데이트</td>
            </tr>
        </table>

        <h3>10.2 업데이트 가이드</h3>

        <h4>소스 코드만 업데이트 (빠른 업데이트)</h4>
        <ol>
            <li>개발 PC에서 수정된 파일만 빌드</li>
            <li>변경된 파일만 USB로 복사:
                <ul>
                    <li>backend/*.py (백엔드 수정 시)</li>
                    <li>frontend/dist/ (프론트엔드 수정 시)</li>
                </ul>
            </li>
            <li>HMI PC의 해당 파일만 교체</li>
            <li>HMI 재시작</li>
        </ol>

        <h4>전체 업데이트 (의존성 변경 시)</h4>
        <ol>
            <li>HMI 종료</li>
            <li>기존 HMI_REAL 폴더 백업</li>
            <li>새 버전 전체를 USB로 전송</li>
            <li>HMI PC에 덮어쓰기</li>
            <li>HMI 시작 및 테스트</li>
        </ol>

        <h3>10.3 백업 및 복원</h3>

        <h4>백업</h4>
        <div class="code-block">REM 설정 파일 백업 (정기적으로 수행 권장)
xcopy C:\HMI_REAL D:\Backup\HMI_REAL_%date:~0,4%%date:~5,2%%date:~8,2%\ /E /I /H /Y</div>

        <h4>복원</h4>
        <div class="code-block">REM 백업에서 복원
xcopy D:\Backup\HMI_REAL_20250101\ C:\HMI_REAL\ /E /I /H /Y</div>

        <div class="success">
            <strong>✅ 배포 가이드 완료</strong><br>
            이 문서의 모든 단계를 완료하면 HMI 시스템이 정상적으로 배포 및 운영됩니다.<br>
            <br>
            <strong>핵심 요약:</strong><br>
            1. 개발 PC에서 빌드 (npm run build)<br>
            2. USB로 38MB 파일 전송<br>
            3. HMI PC에 설치 및 실행 테스트<br>
            4. 자동 실행 설정 (선택)<br>
            5. 정상 작동 확인
        </div>

        <div style="margin-top: 50px; padding: 20px; background-color: #f8f9fa; border-top: 3px solid #3498db;">
            <p style="text-align: center; color: #7f8c8d; margin: 0;">
                <strong>ESS HMI 시스템 완전 배포 가이드</strong><br>
                본 문서는 Microsoft Word에서 열어 편집 및 인쇄할 수 있습니다.
            </p>
        </div>
    </div>
</body>
</html>
